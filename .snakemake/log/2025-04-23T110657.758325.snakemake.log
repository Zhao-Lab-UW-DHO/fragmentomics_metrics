Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 64
Rules claiming more threads will be scaled down.
Job stats:
job                           count    min threads    max threads
--------------------------  -------  -------------  -------------
all                               1              1              1
build_combined_ft                 4              1              1
build_feature_tables              4              1              1
calculate_ATAC_entropy            8              1              1
calculate_MDS                     8              1              1
calculate_SE                      8              1              1
calculate_TFBS_entropy            8              1              1
calculate_frag_bins               8              1              1
calculate_full_gene_depth         8              1              1
calculate_normalized_depth        8              1              1
calculate_small_frags             8              1              1
extract_first_exon                4              1              1
filter_comm_panel_genes           8              1              1
get_SE_fragstats                  8              1              1
get_depth_fragstats               8              1              1
get_left_4mer                     8              1              1
get_right_4mer                    8              1              1
gzip_comm_panel_genes             8              1              1
move_comm_panels                  1              1              1
overlap_ATAC                      8              1              1
overlap_TFBS                      8              1              1
total                           142              1              1

Select jobs to execute...

[Wed Apr 23 11:06:58 2025]
rule filter_comm_panel_genes:
    input: data/MRL0001CH.bed.gz
    output: data/tempus/MRL0001CH.bed
    jobid: 4
    reason: Missing output files: data/tempus/MRL0001CH.bed; Updated input files: data/MRL0001CH.bed.gz
    wildcards: comm_panel=tempus, sample=MRL0001CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:06:58 2025]
rule filter_comm_panel_genes:
    input: data/MRL0001CH.bed.gz
    output: data/guardant/MRL0001CH.bed
    jobid: 6
    reason: Missing output files: data/guardant/MRL0001CH.bed; Updated input files: data/MRL0001CH.bed.gz
    wildcards: comm_panel=guardant, sample=MRL0001CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:06:58 2025]
rule filter_comm_panel_genes:
    input: data/MRL0001CH.bed.gz
    output: data/foundationOne/MRL0001CH.bed
    jobid: 8
    reason: Missing output files: data/foundationOne/MRL0001CH.bed; Updated input files: data/MRL0001CH.bed.gz
    wildcards: comm_panel=foundationOne, sample=MRL0001CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:06:58 2025]
rule filter_comm_panel_genes:
    input: data/MRL0002CH.bed.gz
    output: data/default/MRL0002CH.bed
    jobid: 10
    reason: Missing output files: data/default/MRL0002CH.bed; Updated input files: data/MRL0002CH.bed.gz
    wildcards: comm_panel=default, sample=MRL0002CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:06:58 2025]
rule filter_comm_panel_genes:
    input: data/MRL0002CH.bed.gz
    output: data/tempus/MRL0002CH.bed
    jobid: 12
    reason: Missing output files: data/tempus/MRL0002CH.bed; Updated input files: data/MRL0002CH.bed.gz
    wildcards: comm_panel=tempus, sample=MRL0002CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:06:58 2025]
rule filter_comm_panel_genes:
    input: data/MRL0002CH.bed.gz
    output: data/guardant/MRL0002CH.bed
    jobid: 14
    reason: Missing output files: data/guardant/MRL0002CH.bed; Updated input files: data/MRL0002CH.bed.gz
    wildcards: comm_panel=guardant, sample=MRL0002CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:06:58 2025]
rule filter_comm_panel_genes:
    input: data/MRL0002CH.bed.gz
    output: data/foundationOne/MRL0002CH.bed
    jobid: 16
    reason: Missing output files: data/foundationOne/MRL0002CH.bed; Updated input files: data/MRL0002CH.bed.gz
    wildcards: comm_panel=foundationOne, sample=MRL0002CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:06:58 2025]
rule filter_comm_panel_genes:
    input: data/MRL0001CH.bed.gz
    output: data/default/MRL0001CH.bed
    jobid: 2
    reason: Missing output files: data/default/MRL0001CH.bed; Updated input files: data/MRL0001CH.bed.gz
    wildcards: comm_panel=default, sample=MRL0001CH
    resources: tmpdir=/tmp

[Wed Apr 23 11:09:00 2025]
Finished job 6.
1 of 142 steps (1%) done
Select jobs to execute...

[Wed Apr 23 11:09:00 2025]
rule gzip_comm_panel_genes:
    input: data/guardant/MRL0001CH.bed
    output: data/guardant/MRL0001CH.bed.gz
    jobid: 5
    reason: Missing output files: data/guardant/MRL0001CH.bed.gz; Input files updated by another job: data/guardant/MRL0001CH.bed
    wildcards: comm_panel=guardant, sample=MRL0001CH
    resources: tmpdir=/tmp

[Wed Apr 23 11:09:00 2025]
Finished job 4.
2 of 142 steps (1%) done
Select jobs to execute...

[Wed Apr 23 11:09:00 2025]
rule gzip_comm_panel_genes:
    input: data/tempus/MRL0001CH.bed
    output: data/tempus/MRL0001CH.bed.gz
    jobid: 3
    reason: Missing output files: data/tempus/MRL0001CH.bed.gz; Input files updated by another job: data/tempus/MRL0001CH.bed
    wildcards: comm_panel=tempus, sample=MRL0001CH
    resources: tmpdir=/tmp

[Wed Apr 23 11:09:01 2025]
Finished job 3.
3 of 142 steps (2%) done
Select jobs to execute...

[Wed Apr 23 11:09:01 2025]
rule get_left_4mer:
    input: data/tempus/MRL0001CH.bed.gz, /mnt/Data01/genome/hg19.fa
    output: output/metrics/mds/tempus/MRL0001CH_left_4mers.txt.gz
    jobid: 77
    reason: Missing output files: output/metrics/mds/tempus/MRL0001CH_left_4mers.txt.gz; Input files updated by another job: data/tempus/MRL0001CH.bed.gz
    wildcards: comm_panel=tempus, sample=MRL0001CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:09:01 2025]
rule get_depth_fragstats:
    input: data/tempus/MRL0001CH.bed.gz
    output: output/fragstats/depth_files/tempus/MRL0001CH.txt
    jobid: 34
    reason: Missing output files: output/fragstats/depth_files/tempus/MRL0001CH.txt; Input files updated by another job: data/tempus/MRL0001CH.bed.gz
    wildcards: comm_panel=tempus, sample=MRL0001CH
    priority: 20
    resources: tmpdir=/tmp


[Wed Apr 23 11:09:01 2025]
rule overlap_TFBS:
    input: data/tempus/MRL0001CH.bed.gz, files/Homo_sapiens_meta_clusters_hg19_midpoint_top5k_sorted.bed
    output: output/metrics/TFBS_entropy/tempus/MRL0001CH_TFBS_frag_count.txt.gz
    jobid: 98
    reason: Missing output files: output/metrics/TFBS_entropy/tempus/MRL0001CH_TFBS_frag_count.txt.gz; Input files updated by another job: data/tempus/MRL0001CH.bed.gz
    wildcards: comm_panel=tempus, sample=MRL0001CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:09:01 2025]
rule get_SE_fragstats:
    input: data/tempus/MRL0001CH.bed.gz
    output: output/fragstats/SE_files/tempus/MRL0001CH.txt.gz
    jobid: 18
    reason: Missing output files: output/fragstats/SE_files/tempus/MRL0001CH.txt.gz; Input files updated by another job: data/tempus/MRL0001CH.bed.gz
    wildcards: comm_panel=tempus, sample=MRL0001CH
    priority: 20
    resources: tmpdir=/tmp


[Wed Apr 23 11:09:01 2025]
rule get_right_4mer:
    input: data/tempus/MRL0001CH.bed.gz, /mnt/Data01/genome/hg19.fa
    output: output/metrics/mds/tempus/MRL0001CH_right_4mers.txt.gz
    jobid: 78
    reason: Missing output files: output/metrics/mds/tempus/MRL0001CH_right_4mers.txt.gz; Input files updated by another job: data/tempus/MRL0001CH.bed.gz
    wildcards: comm_panel=tempus, sample=MRL0001CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:09:01 2025]
rule overlap_ATAC:
    input: data/tempus/MRL0001CH.bed.gz, files/TCGA_ATAC_peak.all.probeMap.simple.hg19.bed
    output: output/metrics/ATAC_entropy/tempus/MRL0001CH_ATAC_frag_count.txt.gz
    jobid: 114
    reason: Missing output files: output/metrics/ATAC_entropy/tempus/MRL0001CH_ATAC_frag_count.txt.gz; Input files updated by another job: data/tempus/MRL0001CH.bed.gz
    wildcards: comm_panel=tempus, sample=MRL0001CH
    resources: tmpdir=/tmp

[Wed Apr 23 11:09:03 2025]
Finished job 34.
4 of 142 steps (3%) done
Select jobs to execute...

[Wed Apr 23 11:09:03 2025]
rule calculate_full_gene_depth:
    input: output/fragstats/depth_files/tempus/MRL0001CH.txt
    output: output/metrics/full_gene_depth/tempus/MRL0001CH.fullgenedepth.tsv
    jobid: 66
    reason: Missing output files: output/metrics/full_gene_depth/tempus/MRL0001CH.fullgenedepth.tsv; Input files updated by another job: output/fragstats/depth_files/tempus/MRL0001CH.txt
    wildcards: comm_panel=tempus, sample=MRL0001CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:09:03 2025]
rule calculate_normalized_depth:
    input: output/fragstats/depth_files/tempus/MRL0001CH.txt
    output: output/metrics/depth/tempus/MRL0001CH.depth.tsv
    jobid: 42
    reason: Missing output files: output/metrics/depth/tempus/MRL0001CH.depth.tsv; Input files updated by another job: output/fragstats/depth_files/tempus/MRL0001CH.txt
    wildcards: comm_panel=tempus, sample=MRL0001CH
    resources: tmpdir=/tmp

[Wed Apr 23 11:09:04 2025]
Finished job 5.
5 of 142 steps (4%) done
Select jobs to execute...

[Wed Apr 23 11:09:04 2025]
rule get_SE_fragstats:
    input: data/guardant/MRL0001CH.bed.gz
    output: output/fragstats/SE_files/guardant/MRL0001CH.txt.gz
    jobid: 19
    reason: Missing output files: output/fragstats/SE_files/guardant/MRL0001CH.txt.gz; Input files updated by another job: data/guardant/MRL0001CH.bed.gz
    wildcards: comm_panel=guardant, sample=MRL0001CH
    priority: 20
    resources: tmpdir=/tmp


[Wed Apr 23 11:09:04 2025]
rule get_right_4mer:
    input: data/guardant/MRL0001CH.bed.gz, /mnt/Data01/genome/hg19.fa
    output: output/metrics/mds/guardant/MRL0001CH_right_4mers.txt.gz
    jobid: 81
    reason: Missing output files: output/metrics/mds/guardant/MRL0001CH_right_4mers.txt.gz; Input files updated by another job: data/guardant/MRL0001CH.bed.gz
    wildcards: comm_panel=guardant, sample=MRL0001CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:09:04 2025]
rule overlap_ATAC:
    input: data/guardant/MRL0001CH.bed.gz, files/TCGA_ATAC_peak.all.probeMap.simple.hg19.bed
    output: output/metrics/ATAC_entropy/guardant/MRL0001CH_ATAC_frag_count.txt.gz
    jobid: 115
    reason: Missing output files: output/metrics/ATAC_entropy/guardant/MRL0001CH_ATAC_frag_count.txt.gz; Input files updated by another job: data/guardant/MRL0001CH.bed.gz
    wildcards: comm_panel=guardant, sample=MRL0001CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:09:04 2025]
rule get_left_4mer:
    input: data/guardant/MRL0001CH.bed.gz, /mnt/Data01/genome/hg19.fa
    output: output/metrics/mds/guardant/MRL0001CH_left_4mers.txt.gz
    jobid: 80
    reason: Missing output files: output/metrics/mds/guardant/MRL0001CH_left_4mers.txt.gz; Input files updated by another job: data/guardant/MRL0001CH.bed.gz
    wildcards: comm_panel=guardant, sample=MRL0001CH
    resources: tmpdir=/tmp


[Wed Apr 23 11:09:04 2025]
rule get_depth_fragstats:
    input: data/guardant/MRL0001CH.bed.gz
    output: output/fragstats/depth_files/guardant/MRL0001CH.txt
    jobid: 35
    reason: Missing output files: output/fragstats/depth_files/guardant/MRL0001CH.txt; Input files updated by another job: data/guardant/MRL0001CH.bed.gz
    wildcards: comm_panel=guardant, sample=MRL0001CH
    priority: 20
    resources: tmpdir=/tmp


[Wed Apr 23 11:09:04 2025]
rule overlap_TFBS:
    input: data/guardant/MRL0001CH.bed.gz, files/Homo_sapiens_meta_clusters_hg19_midpoint_top5k_sorted.bed
    output: output/metrics/TFBS_entropy/guardant/MRL0001CH_TFBS_frag_count.txt.gz
    jobid: 99
    reason: Missing output files: output/metrics/TFBS_entropy/guardant/MRL0001CH_TFBS_frag_count.txt.gz; Input files updated by another job: data/guardant/MRL0001CH.bed.gz
    wildcards: comm_panel=guardant, sample=MRL0001CH
    resources: tmpdir=/tmp

[Wed Apr 23 11:09:05 2025]
Error in rule overlap_ATAC:
    jobid: 114
    output: output/metrics/ATAC_entropy/tempus/MRL0001CH_ATAC_frag_count.txt.gz
    shell:
        
        zcat data/tempus/MRL0001CH.bed.gz         | bedtools intersect -a stdin -b files/TCGA_ATAC_peak.all.probeMap.simple.hg19.bed -wa -wb         | awk -F"	" '{OFS=FS}; {split($12, arr, "_"); print arr[1], $3-$2}'         | sort -k1,1 -k2,2n         | uniq -c         | gzip > output/metrics/ATAC_entropy/tempus/MRL0001CH_ATAC_frag_count.txt.gz
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job overlap_ATAC since they might be corrupted:
output/metrics/ATAC_entropy/tempus/MRL0001CH_ATAC_frag_count.txt.gz
[Wed Apr 23 11:09:05 2025]
Finished job 18.
6 of 142 steps (4%) done
[Wed Apr 23 11:09:06 2025]
Finished job 42.
7 of 142 steps (5%) done
[Wed Apr 23 11:09:10 2025]
Finished job 66.
8 of 142 steps (6%) done
[Wed Apr 23 11:09:10 2025]
Error in rule overlap_TFBS:
    jobid: 98
    output: output/metrics/TFBS_entropy/tempus/MRL0001CH_TFBS_frag_count.txt.gz
    shell:
        
        zcat data/tempus/MRL0001CH.bed.gz         | bedtools intersect -a stdin -b files/Homo_sapiens_meta_clusters_hg19_midpoint_top5k_sorted.bed -wa -wb         | awk -F"	" 'BEGIN {OFS=FS} {print $3-$2, $12}'         | sort -k2,2 -k1,1n         | uniq -c         | gzip  > output/metrics/TFBS_entropy/tempus/MRL0001CH_TFBS_frag_count.txt.gz
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job overlap_TFBS since they might be corrupted:
output/metrics/TFBS_entropy/tempus/MRL0001CH_TFBS_frag_count.txt.gz
[Wed Apr 23 11:09:13 2025]
Finished job 35.
9 of 142 steps (6%) done
[Wed Apr 23 11:09:15 2025]
Error in rule get_left_4mer:
    jobid: 77
    output: output/metrics/mds/tempus/MRL0001CH_left_4mers.txt.gz
    shell:
        
        zcat data/tempus/MRL0001CH.bed.gz         | awk -F "	" '{OFS=FS}; {print $1, $2, $2+4, $4, $5, $6, $7, $8}'         | bedtools getfasta -fi /mnt/Data01/genome/hg19.fa -bed stdin -bedOut         | awk -F "	" '{OFS=FS}; {print $6, $7, toupper($9)}'         | sort -k1,1 -k2,2n -k3,3         | uniq -c         | gzip > output/metrics/mds/tempus/MRL0001CH_left_4mers.txt.gz
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job get_left_4mer since they might be corrupted:
output/metrics/mds/tempus/MRL0001CH_left_4mers.txt.gz
[Wed Apr 23 11:09:16 2025]
Error in rule get_right_4mer:
    jobid: 78
    output: output/metrics/mds/tempus/MRL0001CH_right_4mers.txt.gz
    shell:
        
        zcat data/tempus/MRL0001CH.bed.gz         | awk -F "	" '{OFS=FS}; {print $1, $3-4, $3, $4, $5, "-", $6, $7, $8}'         | bedtools getfasta -fi /mnt/Data01/genome/hg19.fa -bed stdin -bedOut -s         | awk -F "	" '{OFS=FS}; {print $7, $8, toupper($10)}'         | sort -k1,1 -k2,2n -k3,3         | uniq -c         | gzip > output/metrics/mds/tempus/MRL0001CH_right_4mers.txt.gz
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job get_right_4mer since they might be corrupted:
output/metrics/mds/tempus/MRL0001CH_right_4mers.txt.gz
[Wed Apr 23 11:09:20 2025]
Finished job 115.
10 of 142 steps (7%) done
[Wed Apr 23 11:09:24 2025]
Finished job 19.
11 of 142 steps (8%) done
[Wed Apr 23 11:09:26 2025]
Finished job 99.
12 of 142 steps (8%) done
[Wed Apr 23 11:09:37 2025]
Finished job 8.
13 of 142 steps (9%) done
[Wed Apr 23 11:09:37 2025]
Finished job 2.
14 of 142 steps (10%) done
[Wed Apr 23 11:10:10 2025]
Finished job 80.
15 of 142 steps (11%) done
[Wed Apr 23 11:10:14 2025]
Finished job 81.
16 of 142 steps (11%) done
[Wed Apr 23 11:10:57 2025]
Finished job 12.
17 of 142 steps (12%) done
[Wed Apr 23 11:10:57 2025]
Finished job 14.
18 of 142 steps (13%) done
[Wed Apr 23 11:10:57 2025]
Finished job 10.
19 of 142 steps (13%) done
[Wed Apr 23 11:11:42 2025]
Finished job 16.
20 of 142 steps (14%) done
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2025-04-23T110657.758325.snakemake.log
